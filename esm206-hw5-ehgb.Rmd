---
title: "esm206-hw5-ehgb"
author: "Evan Heberlein & Grace Brofman"
date: "11/25/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Intro & methods last

Results:
Section A visualize - Evan
Section B table - Grace
Section C chi squared - Grace
Section D t-test - Grace
Section E ANOVA - Evan

```{r}
library(tidyverse)
library(janitor)
library(beeswarm)
library(car)
library(ggbeeswarm)
library(kableExtra)
```

```{r}
salamanders <- read_csv("mack_creek_vertebrates.csv") %>% 
  clean_names() %>% 
  filter(species == "DITE")

view(salamanders)

salamander_violin <- ggplot(data = salamanders, 
                            aes(x = section, y = length1)) +
  geom_violin()

salamander_violin

salamander_og <- salamanders %>% 
  filter(section == "OG")

#og_hist <- ggplot(data = salamander_og, aes(x = ))

salamander_cc <- salamanders %>% 
  filter(section == "CC")
```

### Results B: Table
Results B: Table of 2017 salamander counts by channel classification (pool, cascades and side-channel) in old growth (OG) and clear cut (CC) sections of Mack Creek. Using only Pacific giant salamander observations from 2017, create a finalized table showing the counts and proportions of salamanders observed in different channel classifications (pool, cascade, or side-channel) within Mack Creek for the two sections (OG and CC). Add a table caption above the table. Note: Weâ€™re only interested in Pacific giant salamanders observed in the creek, so you should exclude salamanders observed in isolated pools (IP) disconnected from the channel. 

```{r}

salamanders_2017 <- salamanders %>%   # contains only section and unittype
  filter(year == "2017") %>% 
  select(section, unittype) %>% 
  filter(unittype != "IP")


# finding salamander counts by section and unit type (cascade, pool, side channel)
salamander_2017_counts <- salamanders_2017 %>%  
  count(section, unittype)

# making a table / wider format / contingency table
salamander_2017_table <- salamander_2017_counts %>% 
  pivot_wider(names_from = unittype,
              values_from = n)

# making a nicer table! 
salamander_2017_props <- salamander_2017_table %>% 
  adorn_percentages(denominator = "row") %>% 
  adorn_pct_formatting(digits = 1) %>% 
  adorn_ns(position = "front")

salamander_2017_props

kable(salamander_2017_props) %>% 
  kable_styling()

```

